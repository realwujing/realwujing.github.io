

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicon.jpg">
  <link rel="icon" href="/images/favicon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Wu Jing">
  <meta name="keywords" content="3d, Linux-0.11-yuan-xy, ThreadPool, acpi, algorithm, architect, assembly, baohua, binary-analysis, books, boot, bpf, bugs, ceph, cmake-objdump, console, container, cpp, dbus, deb, debug, deepin, develop, disk, distro, docker, drivers, extern, fluid, fs, gdb, git, go, gpu, grtrace, grub, hello_world, hexo, irq, java, javascript, jenkins, k8s, kdump, kernel, kickstart, kms, kvm, linux, linux-0.11-debug, log, ltp, markdown, minifs, mm, modules, monitoring, mutex, my-project, net, nginx, patent, perf, perf-event, performance, phytium, pkg, port-forward, power, proc, protobuf, protobuf_example, proxy, pthread, pulseaudio, python, qemu, qprocess_wget, qt-learning, rcu, redis, rpm-ostree, runoob-vue3-test, security, shell, sound, sources, stanford-cs336, stap, struct, svn, sync, sysrq_trigger, task, testing, thread, tick, todolist, tools, udl, unixbench, uts_namespace, valgrind, vim, virsh, virt, xisai">
  
    <meta name="description" content="Linux 内核 AI 基础设计 (AI Infra) 参与指南在 linux 目录下，如果你希望深度参与 AI 基础设计（AI Infra），以下是按核心价值排序的技术地图。高优先级的“必争之地”排在最前面：  第一梯队：算力核心与异构管理 (Core Compute &amp; Heterogeneous Management)这是 AI Infra 的心脏，决定了内核如何与 AI 芯片对话。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 内核 AI 基础设计 (AI Infra) 参与指南">
<meta property="og:url" content="https://realwujing.github.io/linux/drivers/gpu/ai_infra/index.html">
<meta property="og:site_name" content="WuJing&#39;s Blog">
<meta property="og:description" content="Linux 内核 AI 基础设计 (AI Infra) 参与指南在 linux 目录下，如果你希望深度参与 AI 基础设计（AI Infra），以下是按核心价值排序的技术地图。高优先级的“必争之地”排在最前面：  第一梯队：算力核心与异构管理 (Core Compute &amp; Heterogeneous Management)这是 AI Infra 的心脏，决定了内核如何与 AI 芯片对话。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2026-01-19T11:21:49.000Z">
<meta property="article:modified_time" content="2026-01-19T11:21:49.000Z">
<meta property="article:author" content="Wu Jing">
<meta property="article:tag" content="bpf">
<meta property="article:tag" content="drivers">
<meta property="article:tag" content="fs">
<meta property="article:tag" content="git">
<meta property="article:tag" content="gpu">
<meta property="article:tag" content="kernel">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="log">
<meta property="article:tag" content="monitoring">
<meta property="article:tag" content="perf">
<meta property="article:tag" content="performance">
<meta property="article:tag" content="virt">
<meta property="article:tag" content="mm">
<meta property="article:tag" content="net">
<meta property="article:tag" content="modules">
<meta property="article:tag" content="proc">
<meta property="article:tag" content="security">
<meta property="article:tag" content="irq">
<meta name="twitter:card" content="summary_large_image">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Linux 内核 AI 基础设计 (AI Infra) 参与指南 - WuJing&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"realwujing.github.io","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"6b5123e146041483d13bdfaeb6e42a76","google":"UA-265632133-1","gtag":"G-E7BV6T4RCW","tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?6b5123e146041483d13bdfaeb6e42a76";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  
    <!-- Google Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript('https://www.google-analytics.com/analytics.js', function() {
          window.ga = window.ga || function() { (ga.q = ga.q || []).push(arguments) };
          ga.l = +new Date;
          ga('create', 'UA-265632133-1', 'auto');
          ga('send', 'pageview');
        });
      }
    </script>
  

  
    <!-- Google gtag.js -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript('https://www.googletagmanager.com/gtag/js?id=G-E7BV6T4RCW', function() {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-E7BV6T4RCW');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>WuJing&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Linux 内核 AI 基础设计 (AI Infra) 参与指南"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-01-19 11:21" pubdate>
          2026年1月19日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          5.2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          43 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Linux 内核 AI 基础设计 (AI Infra) 参与指南</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="Linux-内核-AI-基础设计-AI-Infra-参与指南"><a href="#Linux-内核-AI-基础设计-AI-Infra-参与指南" class="headerlink" title="Linux 内核 AI 基础设计 (AI Infra) 参与指南"></a>Linux 内核 AI 基础设计 (AI Infra) 参与指南</h1><p>在 <code>linux</code> 目录下，如果你希望深度参与 <strong>AI 基础设计（AI Infra）</strong>，以下是按核心价值排序的技术地图。高优先级的“必争之地”排在最前面：</p>
<hr>
<h2 id="第一梯队：算力核心与异构管理-Core-Compute-Heterogeneous-Management"><a href="#第一梯队：算力核心与异构管理-Core-Compute-Heterogeneous-Management" class="headerlink" title="第一梯队：算力核心与异构管理 (Core Compute &amp; Heterogeneous Management)"></a>第一梯队：算力核心与异构管理 (Core Compute &amp; Heterogeneous Management)</h2><p><em>这是 AI Infra 的心脏，决定了内核如何与 AI 芯片对话。</em></p>
<h3 id="1-AI-加速器子系统-drivers-accel"><a href="#1-AI-加速器子系统-drivers-accel" class="headerlink" title="1. AI 加速器子系统 (drivers/accel/)"></a>1. AI 加速器子系统 (<code>drivers/accel/</code>)</h3><p>这是 Linux 内核中关于 AI Infra 最直接的模块。它是专门为计算加速器（Compute Accelerators）设立的子系统，目标是统一 AI 芯片的驱动架构。</p>
<ul>
<li><strong>关键目录</strong>：<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/accel">drivers&#x2F;accel&#x2F;</a>：子系统核心框架。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/accel/habanalabs">drivers&#x2F;accel&#x2F;habanalabs&#x2F;</a>：Intel Habana Labs AI 芯片驱动。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/accel/amdxdna">drivers&#x2F;accel&#x2F;amdxdna&#x2F;</a>：AMD XDNA AI 引擎驱动。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/accel/ivpu">drivers&#x2F;accel&#x2F;ivpu&#x2F;</a>：Intel NPU (Vision Processing Unit) 驱动。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/accel/qaic">drivers&#x2F;accel&#x2F;qaic&#x2F;</a>：Qualcomm Cloud AI 加速卡驱动。</li>
</ul>
</li>
</ul>
<h3 id="2-GPU-与-DRM-框架-drivers-gpu-drm"><a href="#2-GPU-与-DRM-框架-drivers-gpu-drm" class="headerlink" title="2. GPU 与 DRM 框架 (drivers/gpu/drm/)"></a>2. GPU 与 DRM 框架 (<code>drivers/gpu/drm/</code>)</h3><p>GPU 是当前 AI 计算的基石。在 Linux 中，GPU 驱动不仅负责显示，更重要的是通过 <code>DRM</code> (Direct Rendering Manager) 提供计算接口。</p>
<ul>
<li><strong>参与点</strong>：<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/gpu/drm/amd/amdgpu">drivers&#x2F;gpu&#x2F;drm&#x2F;amd&#x2F;amdgpu&#x2F;</a>：AMD 的高性能计算架构。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/gpu/drm/xe">drivers&#x2F;gpu&#x2F;drm&#x2F;xe&#x2F;</a>：Intel 为其 XPU 架构设计的新一代驱动（性能更优，专为计算优化）。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/gpu/drm/nouveau">drivers&#x2F;gpu&#x2F;drm&#x2F;nouveau&#x2F;</a>：Nvidia 的开源驱动。</li>
</ul>
</li>
</ul>
<h3 id="3-AMD-KFD-Kernel-Fusion-Driver"><a href="#3-AMD-KFD-Kernel-Fusion-Driver" class="headerlink" title="3. AMD KFD (Kernel Fusion Driver)"></a>3. AMD KFD (Kernel Fusion Driver)</h3><p>这是 AMD ROCm 计算栈在内核的核心组件，是除了显卡驱动外最值得 AI 工程师研究的模块。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/gpu/drm/amd/amdkfd">drivers&#x2F;gpu&#x2F;drm&#x2F;amd&#x2F;amdkfd&#x2F;</a>：专门负责异构计算的进程管理、地址空间映射（SVM）和多 GPU 拓扑识别。</li>
</ul>
<h3 id="4-自定义-AI-调度器-sched-ext"><a href="#4-自定义-AI-调度器-sched-ext" class="headerlink" title="4. 自定义 AI 调度器 (sched_ext)"></a>4. 自定义 AI 调度器 (sched_ext)</h3><p>这是当前 Linux 内核调度器领域最前沿的热点，专为大模型训练等负载设计。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/kernel/sched/ext.c">kernel&#x2F;sched&#x2F;ext.c</a>：<strong>sched_ext</strong>。它允许开发者直接在 eBPF 中实现复杂的 AI 任务调度策略，无需重新部署内核，即可在运行时优化 GPU 任务的 CPU 协同调度。</li>
</ul>
<h3 id="5-集用化的加速器调度-drivers-gpu-drm-scheduler"><a href="#5-集用化的加速器调度-drivers-gpu-drm-scheduler" class="headerlink" title="5. 集用化的加速器调度 (drivers/gpu/drm/scheduler/)"></a>5. 集用化的加速器调度 (<code>drivers/gpu/drm/scheduler/</code>)</h3><p>多个 AI 任务如何竞争同一块 GPU 的执行权？</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/gpu/drm/scheduler">drivers&#x2F;gpu&#x2F;drm&#x2F;scheduler&#x2F;</a>：<strong>DRM GPU Scheduler</strong>。这是一个通用的任务调度框架（被 AMD、Intel、ARM 等广泛使用），负责处理任务优先级、依赖关系以及超时恢复（TDR），是 AI 算力调度逻辑的核心。</li>
</ul>
<hr>
<h2 id="第二梯队：内存架构与“内存墙”破局-Memory-Wall-Interconnect"><a href="#第二梯队：内存架构与“内存墙”破局-Memory-Wall-Interconnect" class="headerlink" title="第二梯队：内存架构与“内存墙”破局 (Memory Wall &amp; Interconnect)"></a>第二梯队：内存架构与“内存墙”破局 (Memory Wall &amp; Interconnect)</h2><p><em>AI 模型的上限取决于数据搬运速度。</em></p>
<h3 id="6-异构计算互联-PCIe-CXL"><a href="#6-异构计算互联-PCIe-CXL" class="headerlink" title="6. 异构计算互联 (PCIe &amp; CXL)"></a>6. 异构计算互联 (PCIe &amp; CXL)</h3><p>AI 集群的性能上限往往取决于卡间互联（Interconnect）。</p>
<ul>
<li><strong>CXL (<code>drivers/cxl/</code>)<strong>：</strong>Compute Express Link</strong>，是当前 AI 领域最热门的硬件协议之一，解决了 CPU 与 GPU&#x2F;NPU 之间的内存池化（Memory Pooling）和扩展。</li>
<li>**PCIe P2P (<code>drivers/pci/</code>)**：研究 <strong>Peer-to-Peer DMA</strong>，这是实现 GPU 之间不绕过 CPU 直接传输数据的底层技术，也是 NVLink&#x2F;Infinity Fabric 兼容内核的基础。</li>
</ul>
<h3 id="7-异构内存管理-mm"><a href="#7-异构内存管理-mm" class="headerlink" title="7. 异构内存管理 (mm/)"></a>7. 异构内存管理 (<code>mm/</code>)</h3><p>AI 模型通常很大，CPU 和 GPU&#x2F;NPU 之间的高效内存共享是 AI Infra 的难点。</p>
<ul>
<li><strong>关键代码</strong>：<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/hmm.c">mm&#x2F;hmm.c</a>：**HMM (Heterogeneous Memory Management)**，支持 CPU 和加速器共享统一虚拟地址空间。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/migrate_device.c">mm&#x2F;migrate_device.c</a>：加速器与系统内存之间的数据迁移逻辑。</li>
</ul>
</li>
</ul>
<h3 id="8-多层级内存调度-Memory-Tiering"><a href="#8-多层级内存调度-Memory-Tiering" class="headerlink" title="8. 多层级内存调度 (Memory Tiering)"></a>8. 多层级内存调度 (Memory Tiering)</h3><p>在现代 AI 服务器中，内存不再是单一层级（HBM + DDR + CXL）。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/memory-tiers.c">mm&#x2F;memory-tiers.c</a>：<strong>Memory Tiering</strong> 框架负责决定页面在不同速度内存间的移动（Promotion&#x2F;Demotion），确保热数据留在 HBM，冷数据下放到 CXL。</li>
</ul>
<h3 id="9-虚拟化与直通-IOMMUFD"><a href="#9-虚拟化与直通-IOMMUFD" class="headerlink" title="9. 虚拟化与直通 (IOMMUFD)"></a>9. 虚拟化与直通 (IOMMUFD)</h3><p>在云原生环境下，如何让 AI 算力安全、高效地暴露给容器或虚拟机。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/iommu/iommufd">drivers&#x2F;iommu&#x2F;iommufd&#x2F;</a>：<strong>IOMMUFD</strong>，这是为了支持现代加速器直通而重新设计的框架，极大地提升了 AI 加速器的管理灵活性。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/vfio">drivers&#x2F;vfio&#x2F;</a>：<strong>GPU&#x2F;NPU Passthrough</strong> 的核心实现。</li>
</ul>
<h3 id="10-独立显存的精密管家-drivers-gpu-drm-ttm"><a href="#10-独立显存的精密管家-drivers-gpu-drm-ttm" class="headerlink" title="10. 独立显存的精密管家 (drivers/gpu/drm/ttm/)"></a>10. 独立显存的精密管家 (<code>drivers/gpu/drm/ttm/</code>)</h3><p>对于拥有独立显存（Discrete VRAM）的千亿级参数加速卡，内存管理异常复杂。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/gpu/drm/ttm">drivers&#x2F;gpu&#x2F;drm&#x2F;ttm&#x2F;</a>：**Translation Table Manager (TTM)**。它负责在系统内存 and 设备显存之间透明地分配、迁移 and 置换数据块，是高性能 AI 芯片处理超显存（Out-of-Core）任务的底层依赖。</li>
</ul>
<hr>
<h2 id="第三梯队：分布式集群与极速通信-Scaling-High-Speed-Networking"><a href="#第三梯队：分布式集群与极速通信-Scaling-High-Speed-Networking" class="headerlink" title="第三梯队：分布式集群与极速通信 (Scaling &amp; High-Speed Networking)"></a>第三梯队：分布式集群与极速通信 (Scaling &amp; High-Speed Networking)</h2><p><em>万卡集群的效率取决于网络协议栈的开销。</em></p>
<h3 id="11-高性能互联与-RDMA-drivers-infiniband"><a href="#11-高性能互联与-RDMA-drivers-infiniband" class="headerlink" title="11. 高性能互联与 RDMA (drivers/infiniband/)"></a>11. 高性能互联与 RDMA (<code>drivers/infiniband/</code>)</h3><p>分布式 AI 训练需要极低延迟的网络栈。RDMA (Remote Direct Memory Access) 是大模型集群（如万卡集群）的核心。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/infiniband">drivers&#x2F;infiniband&#x2F;</a>：包括 Mellanox (Nvidia) 等厂商的驱动，支持 RoCE 和 InfiniBand。</li>
</ul>
<h3 id="12-混合动力通信层-SMC"><a href="#12-混合动力通信层-SMC" class="headerlink" title="12. 混合动力通信层 (SMC)"></a>12. 混合动力通信层 (SMC)</h3><p>在大模型集群中实现比原生 TCP 更快的协议栈。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/net/smc">net&#x2F;smc&#x2F;</a>：<strong>Shared Memory Communications</strong>。它为应用程序提供标准 Socket 接口，但在底层利用 RDMA 或共享内存进行通信，极大地提升了模型参数同步的速度。</li>
</ul>
<h3 id="13-极速网络数据路径-XDP"><a href="#13-极速网络数据路径-XDP" class="headerlink" title="13. 极速网络数据路径 (XDP)"></a>13. 极速网络数据路径 (XDP)</h3><p>AI 模型分发和参数梯度交换需要榨干每一比特带宽。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/net/core/xdp.c">net&#x2F;core&#x2F;xdp.c</a>：<strong>Express Data Path</strong>，利用 eBPF 在网卡驱动层直接处理报文。参与这里可以设计出极低延迟的 AI 集群通信组件。</li>
</ul>
<h3 id="14-集群级拥塞算法调优-net-ipv4-tcp-congestion-c"><a href="#14-集群级拥塞算法调优-net-ipv4-tcp-congestion-c" class="headerlink" title="14. 集群级拥塞算法调优 (net/ipv4/tcp_congestion.c)"></a>14. 集群级拥塞算法调优 (<code>net/ipv4/tcp_congestion.c</code>)</h3><p>万卡集群内，如何避免网络拥塞导致的训练停滞？</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/net/ipv4/tcp_congestion.c">net&#x2F;ipv4&#x2F;tcp_congestion.c</a>：通过在这里实现或优化拥塞控制算法（如 BBRv3 或专用 AI 算法），可以极大降低分布式训练中的长尾延迟（Tail Latency）。</li>
</ul>
<hr>
<h2 id="第四梯队：极致性能观测与诊断-Observability-Profiling"><a href="#第四梯队：极致性能观测与诊断-Observability-Profiling" class="headerlink" title="第四梯队：极致性能观测与诊断 (Observability &amp; Profiling)"></a>第四梯队：极致性能观测与诊断 (Observability &amp; Profiling)</h2><p><em>看不见的瓶颈是最大的浪费。</em></p>
<h3 id="15-可观测性核心-eBPF"><a href="#15-可观测性核心-eBPF" class="headerlink" title="15. 可观测性核心 (eBPF)"></a>15. 可观测性核心 (eBPF)</h3><p>eBPF 正在成为 AI Infra 监控和调度的利器：</p>
<ul>
<li>**eBPF (<code>kernel/bpf/</code>)**：用于 AI 集群的性能画像（Profiling）、网络流量整形以及定制化的 GPU 任务监控。</li>
</ul>
<h3 id="16-统一硬件性能计数器-Hardware-PMU"><a href="#16-统一硬件性能计数器-Hardware-PMU" class="headerlink" title="16. 统一硬件性能计数器 (Hardware PMU)"></a>16. 统一硬件性能计数器 (Hardware PMU)</h3><p>获取 AI 芯片内部的最底层指标（如算力利用率、Cache 命中率）。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/perf">drivers&#x2F;perf&#x2F;</a>：除了通用 perf，这里包含了各厂商特定的 Performance Monitoring Unit 驱动。</li>
</ul>
<h3 id="17-系统压力“急救包”-PSI"><a href="#17-系统压力“急救包”-PSI" class="headerlink" title="17. 系统压力“急救包” (PSI)"></a>17. 系统压力“急救包” (PSI)</h3><p>在 AI 训练压榨系统极致性能时，如何防止系统由于内存或 IO 过载而瞬间“休克”。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/kernel/sched/psi.c">kernel&#x2F;sched&#x2F;psi.c</a>：<strong>Pressure Stall Information</strong>。通过监控 CPU、内存、IO 的竞争压力，AI 训练框架可以实现更加智能的降速或 OOM 提前规避。</li>
</ul>
<h3 id="18-数据访问画像与自动化调优-DAMON"><a href="#18-数据访问画像与自动化调优-DAMON" class="headerlink" title="18. 数据访问画像与自动化调优 (DAMON)"></a>18. 数据访问画像与自动化调优 (DAMON)</h3><p>大模型训练中哪些数据是“热点”？哪些可以挪到慢速内存？</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/mm/damon">mm&#x2F;damon&#x2F;</a>：<strong>Data Access MONitoring</strong>，内核原语级的数据访问监控框架。</li>
</ul>
<hr>
<h2 id="第五梯队：高速数据加载-Storage-Feeding"><a href="#第五梯队：高速数据加载-Storage-Feeding" class="headerlink" title="第五梯队：高速数据加载 (Storage &amp; Feeding)"></a>第五梯队：高速数据加载 (Storage &amp; Feeding)</h2><p><em>确保 GPU “粮食”供应永不断货。</em></p>
<h3 id="19-数据加载加速-fs-io-uring-c"><a href="#19-数据加载加速-fs-io-uring-c" class="headerlink" title="19. 数据加载加速 (fs/io_uring.c)"></a>19. 数据加载加速 (<code>fs/io_uring.c</code>)</h3><p>利用 io_uring 减少训练过程中海量小文件的 IO 系统调用开销。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/fs/io_uring.c">fs&#x2F;io_uring.c</a>：高性能异步 IO 框架。</li>
</ul>
<h3 id="20-直接访问技术-DAX"><a href="#20-直接访问技术-DAX" class="headerlink" title="20. 直接访问技术 (DAX)"></a>20. 直接访问技术 (DAX)</h3><p>在 AI 模型部署时，如何绕过内核 Page Cache，实现真正的“零拷贝”加载。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/fs/dax.c">fs&#x2F;dax.c</a>：直接访问持久化存储，大幅降低推理延迟。</li>
</ul>
<h3 id="21-AI-专属存储网关-NVMe-oF-Target"><a href="#21-AI-专属存储网关-NVMe-oF-Target" class="headerlink" title="21. AI 专属存储网关 (NVMe-oF Target)"></a>21. AI 专属存储网关 (NVMe-oF Target)</h3><p>将 NVMe 存储通过高性能网络直接透传给计算节点。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/nvme/target">drivers&#x2F;nvme&#x2F;target&#x2F;</a>：**NVMe over Fabrics (NVMe-oF)**。</li>
</ul>
<hr>
<h2 id="第六梯队：虚拟化、安全与可靠性-Cloud-Security-RAS"><a href="#第六梯队：虚拟化、安全与可靠性-Cloud-Security-RAS" class="headerlink" title="第六梯队：虚拟化、安全与可靠性 (Cloud, Security &amp; RAS)"></a>第六梯队：虚拟化、安全与可靠性 (Cloud, Security &amp; RAS)</h2><p><em>生产环境的最后一道防线。</em></p>
<h3 id="22-AI-机密计算-Confidential-AI"><a href="#22-AI-机密计算-Confidential-AI" class="headerlink" title="22. AI 机密计算 (Confidential AI)"></a>22. AI 机密计算 (Confidential AI)</h3><p>保护昂贵的模型资产和敏感训练数据。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/virt/coco">drivers&#x2F;virt&#x2F;coco&#x2F;</a>：涉及 Intel TDX &#x2F; AMD SEV。</li>
</ul>
<h3 id="23-GPU-硬件切分与虚拟化-PCIe-SR-IOV"><a href="#23-GPU-硬件切分与虚拟化-PCIe-SR-IOV" class="headerlink" title="23. GPU 硬件切分与虚拟化 (PCIe SR-IOV)"></a>23. GPU 硬件切分与虚拟化 (PCIe SR-IOV)</h3><p>如何在虚拟化环境下，将一张物理 GPU 拆分成多个强隔离实例。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/drivers/pci/iov.c">drivers&#x2F;pci&#x2F;iov.c</a>：<strong>Single Root I&#x2F;O Virtualization</strong>。</li>
</ul>
<h3 id="24-集群稳定性与纠错-RAS-EDAC"><a href="#24-集群稳定性与纠错-RAS-EDAC" class="headerlink" title="24. 集群稳定性与纠错 (RAS &amp; EDAC)"></a>24. 集群稳定性与纠错 (RAS &amp; EDAC)</h3><p>在大规模 GPU 集群中处理显存翻转（Bit Flip）。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/edac">drivers&#x2F;edac&#x2F;</a>：内存错误检测与纠正。</li>
<li><a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/ras">drivers&#x2F;ras&#x2F;</a>：内核可靠性管理框架。</li>
</ul>
<hr>
<h2 id="其他重要基石模块-Other-Foundation-Modules"><a href="#其他重要基石模块-Other-Foundation-Modules" class="headerlink" title="其他重要基石模块 (Other Foundation Modules)"></a>其他重要基石模块 (Other Foundation Modules)</h2><ul>
<li><strong>内存优化</strong>：<a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/hugetlb.c">mm&#x2F;hugetlb.c</a> (大页支持), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/khugepaged.c">mm&#x2F;khugepaged.c</a> (透明大页), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/compaction.c">mm&#x2F;compaction.c</a> (内存规整), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/zswap.c">mm&#x2F;zswap.c</a> (内存压缩)。</li>
<li><strong>计算原语</strong>：<a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/arch/x86/kernel/fpu/xstate.c">arch&#x2F;x86&#x2F;kernel&#x2F;fpu&#x2F;xstate.c</a> (AMX 支持), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/fpga">drivers&#x2F;fpga&#x2F;</a> (可重构 AI 算力), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/dma">drivers&#x2F;dma&#x2F;</a> (DMA 编排)。</li>
<li><strong>边缘&#x2F;嵌入式</strong>：<a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/remoteproc">drivers&#x2F;remoteproc&#x2F;</a> (NPU 管理), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/rpmsg">drivers&#x2F;rpmsg&#x2F;</a> (低延迟通信), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/iommu/arm/arm-smmu-v3">drivers&#x2F;iommu&#x2F;arm&#x2F;arm-smmu-v3&#x2F;</a> (缓存一致性)。</li>
<li><strong>调度与拓扑</strong>：<a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/kernel/sched/topology.c">kernel&#x2F;sched&#x2F;topology.c</a> (NUMA 亲和性), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/kernel/sched/fair.c">kernel&#x2F;sched&#x2F;fair.c</a> (EAS 调度)。</li>
<li><strong>同步与共享</strong>：<a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/dma-buf">drivers&#x2F;dma-buf&#x2F;</a> (零拷贝同步), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/mm/memfd.c">mm&#x2F;memfd.c</a> (张量共享)。</li>
<li><strong>基础设施管理</strong>：<a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/fwctl">drivers&#x2F;fwctl&#x2F;</a> (固件控制), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/tree/master/drivers/thermal">drivers&#x2F;thermal&#x2F;</a> (能效温控), <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux/blob/master/kernel/irq/affinity.c">kernel&#x2F;irq&#x2F;affinity.c</a> (中断平衡)。</li>
</ul>
<hr>
<p><strong>建议入门路径</strong>：</p>
<ol>
<li><strong>算力核心</strong>：从 <code>drivers/accel/</code> 了解新一代 AI 架构的设计思想。</li>
<li><strong>调度突破</strong>：关注 <code>sched_ext</code>，这是目前内核界将 eBPF 与 AI 结合最成功的案例。</li>
<li><strong>内存破局</strong>：研究 <code>CXL</code> 与 <code>Memory Tiering</code>，这是大模型时代解决存储成本与性能矛盾的终极方案。</li>
</ol>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/linux/" class="category-chain-item">linux</a>
  
  
    <span>></span>
    
  <a href="/categories/linux/drivers/" class="category-chain-item">drivers</a>
  
  
    <span>></span>
    
  <a href="/categories/linux/drivers/gpu/" class="category-chain-item">gpu</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/bpf/">#bpf</a>
      
        <a href="/tags/drivers/">#drivers</a>
      
        <a href="/tags/fs/">#fs</a>
      
        <a href="/tags/git/">#git</a>
      
        <a href="/tags/gpu/">#gpu</a>
      
        <a href="/tags/kernel/">#kernel</a>
      
        <a href="/tags/linux/">#linux</a>
      
        <a href="/tags/log/">#log</a>
      
        <a href="/tags/monitoring/">#monitoring</a>
      
        <a href="/tags/perf/">#perf</a>
      
        <a href="/tags/performance/">#performance</a>
      
        <a href="/tags/virt/">#virt</a>
      
        <a href="/tags/mm/">#mm</a>
      
        <a href="/tags/net/">#net</a>
      
        <a href="/tags/modules/">#modules</a>
      
        <a href="/tags/proc/">#proc</a>
      
        <a href="/tags/security/">#security</a>
      
        <a href="/tags/irq/">#irq</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Linux 内核 AI 基础设计 (AI Infra) 参与指南</div>
      <div>https://realwujing.github.io/linux/drivers/gpu/ai_infra/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Wu Jing</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2026年1月19日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/linux/performance/linux_tracing_architecture/" title="Linux 追踪与性能分析框架全景图">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Linux 追踪与性能分析框架全景图</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/linux/kernel/mm/min_free_kbytes_gfp_atomic/" title="min_free_kbytes 对 GFP_ATOMIC 内存分配的影响分析">
                        <span class="hidden-mobile">min_free_kbytes 对 GFP_ATOMIC 内存分配的影响分析</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.8.0/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"c11f8471a6ae4d3eea12","clientSecret":"87bfa232882af2b005f4c3352132dd418bf6d113","repo":"realwujing.github.io","owner":"realwujing","admin":["realwujing"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: 'f19351bf47f550e8b3b962c271ec8383'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  





  <script>
  Fluid.utils.createScript('https://lib.baomitu.com/mermaid/8.14.0/mermaid.min.js', function() {
    mermaid.initialize({"theme":"default"});

    Fluid.events.registerRefreshCallback(function() {
      if ('mermaid' in window) {
        mermaid.init();
      }
    });
  });
</script>






    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
